<div class="dashboard-container">
    <div class="dashboard-header">
        <h2>Bem-vindo, {{vm.player.name}}</h2>
        <button class="btn btn-primary" ng-click="vm.openProfileModal()">
            <i class="bi bi-person-circle"></i> Editar Perfil
        </button>
        <div class="balance-section">
            <div class="balance-card">
                <h3>Pontos</h3>
                <p class="balance-value">{{vm.status.point_categories.point}}</p>
                <p class="expiration">Nível {{vm.status.level.level}}</p>
            </div>
            <div class="balance-card">
                <h3>Moedas</h3>
                <p class="balance-value">{{vm.status.point_categories.coins}}</p>
                <p class="expiration">XP: {{vm.status.level_progress.percent_completed}}%</p>
            </div>
        </div>
    </div>

    <!-- Profile Edit Modal -->
    <div class="modal fade" id="profileModal" tabindex="-1" role="dialog" aria-labelledby="profileModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="profileModalLabel">Editar Perfil</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body">
                    <form ng-submit="vm.updateProfile()">
                        <div class="form-group">
                            <label for="name">Nome Completo</label>
                            <input type="text" class="form-control" id="name" ng-model="vm.editedProfile.name" required>
                        </div>
                        <div class="form-group">
                            <label for="phone">Telefone</label>
                            <input type="tel" class="form-control" id="phone" ng-model="vm.editedProfile.extra.phone">
                        </div>
                        <div class="form-group">
                            <label for="cpf">CPF</label>
                            <input type="text" class="form-control" id="cpf" ng-model="vm.editedProfile.extra.cpf">
                        </div>
                        <div class="form-group">
                            <label for="birthdate">Data de Nascimento</label>
                            <input type="date" class="form-control" id="birthdate" ng-model="vm.editedProfile.extra.birthdate">
                        </div>
                        <div class="form-group">
                            <label for="cep">CEP</label>
                            <input type="text" class="form-control" id="cep" ng-model="vm.editedProfile.extra.cep">
                        </div>
                        <div class="form-group">
                            <label for="company">Empresa</label>
                            <input type="text" class="form-control" id="company" ng-model="vm.editedProfile.extra.company">
                        </div>
                        <div class="form-group">
                            <label for="sports">Esportes</label>
                            <select class="form-control" id="sports" ng-model="vm.editedProfile.extra.sports" multiple>
                                <option value="soccer">Futebol</option>
                                <option value="basketball">Basquete</option>
                                <option value="tennis">Tênis</option>
                                <option value="swimming">Natação</option>
                                <option value="running">Corrida</option>
                            </select>
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                            <button type="submit" class="btn btn-primary" ng-disabled="vm.updating">Salvar Alterações</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Debug Information -->
    <div class="card mb-4">
        <div class="card-header">
            <h5 class="mb-0">Debug Information</h5>
        </div>
        <div class="card-body">
            <div class="mb-3">
                <label class="form-label">Current Auth Token:</label>
                <div class="input-group">
                    <input type="text" class="form-control" ng-model="vm.currentToken" readonly>
                    <button class="btn btn-outline-secondary" type="button" ng-click="vm.copyToken()">
                        <i class="bi bi-clipboard"></i> Copy
                    </button>
                </div>
            </div>
        </div>
    </div>

    <div class="dashboard-content">
        <div class="activity-section">
            <h3>Atividades Recentes</h3>
            <div class="activity-list">
                <div ng-repeat="activity in vm.activities" class="activity-item">
                    <div class="activity-icon" ng-class="activity.type"></div>
                    <div class="activity-details">
                        <p class="activity-description">{{activity.description}}</p>
                        <p class="activity-date">{{activity.date | date:'dd/MM/yyyy HH:mm'}}</p>
                    </div>
                    <div class="activity-points" ng-if="activity.points">
                        <span ng-class="{'positive': activity.points > 0, 'negative': activity.points < 0}">
                            {{activity.points > 0 ? '+' : ''}}{{activity.points}} pts
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <div class="events-section">
            <h3>Próximos Eventos</h3>
            <div class="events-list">
                <div ng-repeat="event in vm.events" class="event-card">
                    <h4>{{event.title}}</h4>
                    <p class="event-date">{{event.date | date:'dd/MM/yyyy HH:mm'}}</p>
                    <p class="event-description">{{event.description}}</p>
                    <button ng-if="event.canRegister" ng-click="vm.registerForEvent(event)">Participar</button>
                </div>
            </div>
        </div>
    </div>

    <div class="quick-actions">
        <button ng-click="vm.goToRewards()">Loja de Recompensas</button>
        <button ng-click="vm.registerPurchase()">Registrar Compra</button>
        <button ng-click="vm.shareOnSocial()">Compartilhar</button>
    </div>
</div> 